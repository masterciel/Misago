!function(){"use strict";window.Misago=function(){var t=Object.getPrototypeOf(this),e=this;this._initServices=function(n){var o=new t.OrderedList(n).order(!1);o.forEach(function(t){var n=null;n=void 0!==t.item.factory?t.item.factory:t.item;var o=n(e);o&&(e[t.key]=o)})},this._destroyServices=function(n){var o=new t.OrderedList(n).order();o.reverse(),o.forEach(function(t){void 0!==t.destroy&&t.destroy(e)})},this.context={SETTINGS:{}},this.setup=!1,this.init=function(e,n){this.setup={test:t.get(e,"test",!1),api:t.get(e,"api","/api/")},n&&(this.context=n),this._initServices(t._services)},this.destroy=function(){this._destroyServices(t._services)}};var t=window.Misago.prototype;t._services=[],t.addService=function(e,n,o){t._services.push({key:e,item:n,after:t.get(o,"after"),before:t.get(o,"before")})},t.PermissionDenied=function(t){this.detail=t,this.status=403,this.toString=function(){return this.detail||"Permission denied"}}}(),function(t){"use strict";t.has=function(t,e){return t?t.hasOwnProperty(e):!1},t.get=function(e,n,o){return t.has(e,n)?e[n]:void 0!==o?o:void 0},t.pop=function(e,n,o){var i=t.get(e,n,o);return t.has(e,n)&&(e[n]=null),i}}(Misago.prototype),function(t){"use strict";function e(t,e,n){n.retain=!0}t.input=function(t){var n={disabled:t.disabled||!1,config:t.config||e};t.placeholder&&(n.placeholder=t.placeholder),t.autocomplete===!1&&(n.autocomplete="off");var o="input";return t.id&&(o+="#"+t.id,n.key="field-"+t.id),o+=".form-control"+(t["class"]||""),o+='[type="'+(t.type||"text")+'"]',t.value&&(n.value=t.value(),n.oninput=m.withAttr("value",t.value)),m(o,n)}}(Misago.prototype),function(t){"use strict";var e=function(){};t.stateHooks=function(t,n,o){if(t._hasLifecycleHooks)return t;t._hasLifecycleHooks=!0,t.isActive=!0;var i=o.bind(t),r=t.controller||e;if(t.controller=function(){try{t.isActive=!0;var n=r.apply(t,arguments)||{},o=n.onunload||e;return n.onunload=function(){o.apply(t,arguments),t.isActive=!1},n}catch(s){i(s)}},t.vm&&t.vm.init){if(!t.loading){var s=n.bind(t);t.loading=s}var a=t.view;t.view=function(){return t.vm.isReady?a.apply(t,arguments):t.loading.apply(t,arguments)};var u=t.vm.init;t.vm.init=function(){var e=arguments,n=u.apply(t.vm,e);n&&n.then(function(){if(t.isActive&&t.vm.ondata){for(var n=[],o=0;o<arguments.length;o++)n.push(arguments[o]);for(var i=0;i<e.length;i++)n.push(e[i]);t.vm.ondata.apply(t.vm,n)}},function(e){t.isActive&&i(e)})}}return t}}(Misago.prototype),function(t){"use strict";t.OrderedList=function(e){this.isOrdered=!1,this._items=e||[],this.add=function(e,n,o){this._items.push({key:e,item:n,after:t.get(o,"after"),before:t.get(o,"before")})},this.get=function(t,e){for(var n=0;n<this._items.length;n++)if(this._items[n].key===t)return this._items[n].item;return e},this.has=function(t){return void 0!==this.get(t)},this.values=function(){for(var t=[],e=0;e<this._items.length;e++)t.push(this._items[e].item);return t},this.order=function(t){return this.isOrdered||(this._items=this._order(this._items),this.isOrdered=!0),t||"undefined"==typeof t?this.values():this._items},this._order=function(t){function e(t){var e=-1;-1===i.indexOf(t.key)&&(t.after?(e=i.indexOf(t.after),-1!==e&&(e+=1)):t.before&&(e=i.indexOf(t.before)),-1!==e&&(o.splice(e,0,t),i.splice(e,0,t.key)))}var n=[];t.forEach(function(t){n.push(t.key)});var o=[],i=[];t.forEach(function(t){t.after||t.before||(o.push(t),i.push(t.key))}),t.forEach(function(t){"_end"===t.before&&(o.push(t),i.push(t.key))});for(var r=200;r>0&&n.length!==i.length;)r-=1,t.forEach(e);return o}}}(Misago.prototype),function(t){"use strict";t.Page=function(e,n){var o=this;this.name=e,this.isFinalized=!1,this._sections=[];var i=function(){if(!o.isFinalized){o.isFinalized=!0;var e=[];o._sections.forEach(function(t){(!t.visibleIf||t.visibleIf(n))&&e.push(t)}),o._sections=new t.OrderedList(e).order(!0)}};this.addSection=function(t){if(this.isFinalized)throw this.name+" page was initialized already and no longer accepts new sections";this._sections.push({key:t.link,item:t,after:t.after,before:t.before})},this.getSections=function(){return i(),this._sections},this.getDefaultLink=function(){return i(),this._sections[0].link}}}(Misago.prototype),function(t){t.serializeDatetime=function(t){return t?t.format():null},t.deserializeDatetime=function(t){return t?moment(t):null}}(Misago.prototype),function(t){"use strict";t.startsWith=function(t,e){return 0===t.indexOf(e)},t.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)}}(Misago.prototype),function(t){"use strict";var e=function(e){if(-1!==document.cookie.indexOf(e)){var n=new RegExp(e+"=([^;]*)"),o=t.get(document.cookie.match(n),0);return o.split("=")[1]}return null},n=function(n){this.refreshCsrfToken=function(){this.csrfToken=e(n.context.CSRF_COOKIE_NAME)},this.refreshCsrfToken();var o={};this.ajax=function(e,n,i,r){var s=m.deferred(),a={url:n,method:e,headers:{"X-CSRFToken":this.csrfToken},data:i||{},dataType:"json",success:function(i){"GET"===e&&t.pop(o,n),s.resolve(i)},error:function(i){"GET"===e&&t.pop(o,n);var r=i.responseJSON||{};r.status=i.status,r.statusText=i.statusText,s.reject(r)}};return r?void 0:($.ajax(a),s.promise)},this.get=function(t){return void 0!==o[t]?o[t]:(o[t]=this.ajax("GET",t),o[t])},this.post=function(t,e){return this.ajax("POST",t,e)},this.patch=function(t,e){return this.ajax("PATCH",t,e)},this.put=function(t,e){return this.ajax("PUT",t,e)},this["delete"]=function(t){return this.ajax("DELETE",t)},this.error=function(t){t.ban?(n.showBannedPage(t.ban),n.modal()):this.alert(t)},this.alert=function(t){var e=gettext("Unknown error has occured.");0===t.status&&(e=gettext("Lost connection with application.")),400===t.status&&t.detail&&(e=t.detail),403===t.status&&(e=t.detail,"Permission denied"===e&&(e=gettext("You don't have permission to perform this action."))),404===t.status&&(e=gettext("Action link is invalid.")),n.alert.error(e)}};t.addService("ajax",function(t){return new n(t)})}(Misago.prototype),function(t){"use strict";var e=5e3,n=70,o=9e3,i=300,r=function(t){var r=this;this.type="",this.message=null,this.isVisible=!1;var s=function(i,s){r.type=i,r.message=s,r.isVisible=!0;var a=e;a+=s.length*n,a>o&&(a=o),t.runloop.runOnce(function(){m.startComputation(),r.isVisible=!1,m.endComputation()},"flash-message-hide",a)},a=function(e,n){t.runloop.stop("flash-message-hide"),t.runloop.stop("flash-message-show"),r.isVisible?(r.isVisible=!1,t.runloop.runOnce(function(){m.startComputation(),s(e,n),m.endComputation()},"flash-message-show",i)):s(e,n)};this.info=function(t){a("info",t)},this.success=function(t){a("success",t)},this.warning=function(t){a("warning",t)},this.error=function(t){a("error",t)}};t.addService("alert",{factory:function(t){return new r(t)}})}(Misago.prototype),function(t){"use strict";var e=function(t){var e=this;t.user=t.models.deserialize("user",t.context.user),this.isDesynced=!1,this.newUser=null;var n=function(n){e.isDesynced||(m.startComputation(),e.isDesynced=!0,n&&(e.newUser=t.localstore.get("auth-user")),m.endComputation())},o=function(n){e.isDesynced||(m.startComputation(),t.user.id!==n.id?(e.isDesynced=!0,e.newUser=n):n&&(t.user=$.extend(t.user,n)),m.endComputation())},i=function(){t.localstore.set("auth-user",t.user),t.localstore.set("auth-is-authenticated",t.user.isAuthenticated),t.localstore.watch("auth-is-authenticated",n),t.localstore.watch("auth-user",o)};i();var r=function(e){var n=document.getElementById(e),o=null;n&&(o=n.dataset.componentName,m.mount(n,t.component(o.replace("user-nav","guest-nav"))))};this.signOut=function(){t.user.isAuthenticated=!1,t.user.isAnonymous=!0,i(),r("user-menu-mount"),r("user-menu-compact-mount")}};t.addService("auth",function(t){return new e(t)},{after:"model:user"})}(Misago.prototype),function(t){"use strict";var e=function(){var t=m.deferred();t.resolve(),this.load=function(){return t.promise},this.value=function(){return null}},n=function(t){var e=this;this.loading=!1,this.question=null,this.value=m.prop("");var n=m.deferred();this.load=function(){return this.value(""),this.question||this.loading||(this.loading=!0,t.api.endpoint("captcha-question").get().then(function(t){e.question=t,n.resolve()},function(){t.ajax.alert(gettext("Failed to load CAPTCHA.")),n.reject()}).then(function(){e.loading=!0})),n.promise},this.component=function(e){return t.component("form-group",{label:this.question.question,labelClass:e.labelClass||null,controlClass:e.controlClass||null,control:t.input({value:t.validate(e.form,"captcha"),id:"id_captcha",disabled:e.form.isBusy}),validation:e.form.errors,validationKey:"captcha",helpText:this.question.help_text})},this.validator=function(){return[]}},o=function(t){this.included=!1,this.question=null;var e=m.deferred(),n=function(e){"undefined"!=typeof grecaptcha?e.resolve():t.runloop.runOnce(function(){n(e)},"loading-grecaptcha",150)};this.load=function(){return"undefined"!=typeof grecaptcha&&grecaptcha.reset(),this.included||(t.include("https://www.google.com/recaptcha/api.js",!0),this.included=!0),n(e),e.promise};var o=function(e,n,o){o.retain=!0,n||grecaptcha.render("recaptcha",{sitekey:t.settings.recaptcha_site_key})};this.component=function(e){var n=m("#recaptcha",{config:o});return t.component("form-group",{label:gettext("Security test"),labelClass:e.labelClass||null,controlClass:e.controlClass||null,control:n,validation:e.form.errors,validationKey:"captcha"})},this.value=function(){return"undefined"!=typeof grecaptcha?grecaptcha.getResponse():""},this.clean=function(t){t.errors.captcha=this.value()?!0:[gettext("This field is required.")]},this.validator=function(){return[]}},i=function(t){var i={no:e,qa:n,re:o},r=new i[t.settings.captcha_type](t);this.value=r.value,this.load=function(){return r.load()},this.component=function(t){return r.component?r.component(t):null},this.validator=function(){return r.validator?r.validator():null},this.clean=function(t){r.clean?r.clean(t):t.errors.captcha=!0}};t.addService("captcha",function(t){return new i(t)},{after:"include"})}(Misago.prototype),function(t){"use strict";var e=function(t,e){if(this._components[t]){if(arguments.length>1){for(var n=[this._components[t]],o=1;o<arguments.length;o+=1)n.push(arguments[o]);return n.push(this),m.component.apply(void 0,n)}return m.component(this._components[t],this)}if(!e)throw'"'+t+"\" component is not registered and can't be created";this._components[t]=e};t.addService("components",function(t){t._components={},t.component=e})}(Misago.prototype),function(t){"use strict";t.addService("conf",function(e){e.settings=t.get(e.context,"SETTINGS",{})})}(Misago.prototype),function(t){"use strict";var e=function(t){var e={};this.toggle=function(n,o){var i=document.getElementById(n);i.hasChildNodes()&&e[n]===o?(e[n]=null,m.mount(i,null),$(i).removeClass("open")):(console.log(i.hasChildNodes()),e[n]=o,m.mount(i,t.component(o)),$(i).addClass("open"))},this.destroy=function(){var t=null;for(var n in e)e.hasOwnProperty(n)&&(t=document.getElementById(n),t&&t.hasChildNodes()&&m.mount(t,null))}};t.addService("dropdown",{factory:function(t){return new e(t)},destroy:function(t){t.dropdown.destroy()}},{before:"components"})}(Misago.prototype),function(t){"use strict";var e=function(t){var e=t.submit,n=t.success,o=t.error;return t.isBusy=!1,t.errors=null,t.submit=function(){return t.isBusy?!1:(t.clean?t.clean()&&(t.isBusy=!0,e.apply(t)):t.isBusy=!0,!1)},t.success=function(){m.startComputation(),n.apply(t,arguments),t.isBusy=!1,m.endComputation()},t.error=function(){m.startComputation(),o.apply(t,arguments),t.isBusy=!1,m.endComputation()},t.hasErrors=function(){if(null===t.errors)return!1;for(var e in t.validation)if(t.validation.hasOwnProperty(e)&&t.errors[e]!==!0)return!0;return!1},t},n=function(t,n){return this._forms[t]?e(n?new this._forms[t](n,this):new this._forms[t](this)):void(this._forms[t]=n)};t.addService("forms",function(t){t._forms={},t.form=n})}(Misago.prototype),function(t){"use strict";var e=function(t,e){e||(t=this.context.STATIC_URL+t),$.ajax({url:t,cache:!0,dataType:"script"})};t.addService("include",function(t){t.include=e},{after:"conf"})}(Misago.prototype),function(t){"use strict";var e=function(e){e.baseUrl=$("base").attr("href");var n=t.get(e.context,"STATIC_URL","/"),o=t.get(e.context,"MEDIA_URL","/"),i=function(t){return function(e){return t+e}};e.staticUrl=i(n),e.mediaUrl=i(o)};t.addService("links",function(t){e(t)})}(Misago.prototype),function(t){"use strict";var e=function(){var t=window.localStorage,e="_misago_",n=[],o=function(t){var e=JSON.parse(t.newValue);$.each(n,function(n,o){o.keyName===t.key&&t.oldValue!==t.newValue&&o.callback(e)})};window.addEventListener("storage",o);var i=function(t){return e+t};this.set=function(e,n){t.setItem(i(e),JSON.stringify(n))},this.get=function(e){var n=t.getItem(i(e));return n?JSON.parse(n):null},this.watch=function(t,e){n.push({keyName:i(t),callback:e})},this.destroy=function(){this.watchers=[]}};t.addService("localstore",{factory:function(){return new e},destroy:function(t){t.localstore.destroy()}})}(Misago.prototype),function(t){"use strict";var e=function(t){var e=this,n=document.getElementById("modal-mount"),o=$(n).modal({show:!1});this.open=!1,o.on("hidden.bs.modal",function(){e.open&&!t.setup.test&&(m.mount(n,null),this.open=!1)}),this.show=function(t){this.open=!0,m.mount(document.getElementById("modal-mount"),t),$(n).modal("show")},this.hide=function(){o.modal("hide")}};t.addService("_modal",function(t){return new e(t)},{before:"mount-components"})}(Misago.prototype),function(t){"use strict";var e=function(t,e){if(this._modals[t]){for(var n=[this._modals[t]],o=1;o<arguments.length;o+=1)n.push(arguments[o]);n.push(this),this._modal.show(m.component.apply(m,n))}else t?this._modals[t]=e:this._modal.hide()};t.addService("modals",function(t){t._modals={},t.modal=e},{after:"_modal"})}(Misago.prototype),function(t){"use strict";var e=function(){this.classes={},this.deserializers={},this.add=function(t,e){e["class"]&&(this.classes[t]=e["class"]),e.deserialize&&(this.deserializers[t]=e.deserialize)},this["new"]=function(t,e){return this.classes[t]?(e.id=e.id?String(e.id):null,new this.classes[t](e)):e},this.deserialize=function(t,e){return this.deserializers[t]?this["new"](t,this.deserializers[t](e,this)):this["new"](t,e)}};t.addService("models",function(){return new e})}(Misago.prototype),function(t){"use strict";t.addService("set-momentjs-locale",function(){moment.locale($("html").attr("lang"))})}(Misago.prototype),function(t){"use strict";t.addService("mount-page",function(t){t.mountPage=function(t){var e=document.getElementById("page-mount");m.mount(e,t)}})}(Misago.prototype),function(t){"use strict";var e=function(t){-1===this._mounts.indexOf(t)&&this._mounts.push(t)};t.addService("mounts",function(t){t._mounts=["alert-mount","auth-changed-message-mount","page-component","user-menu-mount","user-menu-compact-mount"],t.addMount=e,t.activeMounts={}}),t.addService("mount-components",{factory:function(t){t._mounts.forEach(function(e){var n=document.getElementById(e);n&&(t.activeMounts[e]=n.dataset.componentName,m.mount(n,t.component(n.dataset.componentName)))})},destroy:function(t){t._mounts.forEach(function(t){var e=document.getElementById(t);e&&e.hasChildNodes()&&m.mount(e,null)})}},{before:"_end"})}(Misago.prototype),function(t){"use strict";var e=function(t){var e=this;this._intervals={};var n=function(t){e._intervals[t]&&(window.clearTimeout(e._intervals[t]),e._intervals[t]=null)};this.run=function(o,i,r){this._intervals[i]=window.setTimeout(function(){n(i);var s=o(t);s!==!1&&e.run(o,i,r)},r)},this.runOnce=function(e,o,i){this._intervals[o]=window.setTimeout(function(){n(o),e(t)},i)},this.stop=function(t){for(var e in this._intervals)t&&t!==e||n(e)}};t.addService("runloop",{factory:function(t){return new e(t)},destroy:function(t){t.runloop.stop()}})}(Misago.prototype),function(t){"use strict";t.addService("show-banned-page",function(t){t.showBannedPage=function(e,n){var o=t.component("banned-page",t.models.deserialize("ban",e));"undefined"!=typeof n&&n||(t.title.set(gettext("You are banned")),window.history.pushState({},"",t.context.BANNED_URL)),t.mountPage(o)}})}(Misago.prototype),function(t){"use strict";t.addService("start-tick",function(t){var e=m.prop();t.runloop.run(function(){m.startComputation(),e(e()+1),m.endComputation()},"tick",6e4)})}(Misago.prototype),function(t){"use strict";var e=function(t){this.set=function(e){e?this._set_complex(e):document.title=t},this._set_complex=function(e){"string"==typeof e&&(e={title:e});var n=e.title;if("undefined"!=typeof e.page&&e.page>1){var o=interpolate(gettext("page %(page)s"),{page:e.page},!0);n+=" ("+o+")"}"undefined"!=typeof e.parent&&(n+=" | "+e.parent),document.title=n+" | "+t}};t.addService("page-title",function(t){t.title=new e(t.settings.forum_name)})}(Misago.prototype),function(t){"use strict";var e=/^(([^<>()[\]\.,;:\s@\"]+(\.[^<>()[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i,n=new RegExp("^[0-9a-z]+$","i");t.validators={required:function(){return function(t){return 0===$.trim(t).length?gettext("This field is required."):void 0}},email:function(t){return function(n){return e.test(n)?void 0:t||gettext("Enter a valid email address.")}},minLength:function(t,e){return function(n){var o="",i=$.trim(n).length;return t>i?(o=e?e(t,i):ngettext("Ensure this value has at least %(limit_value)s character (it has %(show_value)s).","Ensure this value has at least %(limit_value)s characters (it has %(show_value)s).",t),interpolate(o,{limit_value:t,show_value:i},!0)):void 0}},maxLength:function(t,e){return function(n){var o="",i=$.trim(n).length;return i>t?(o=e?e(t,i):ngettext("Ensure this value has at most %(limit_value)s character (it has %(show_value)s).","Ensure this value has at most %(limit_value)s characters (it has %(show_value)s).",t),interpolate(o,{limit_value:t,show_value:i},!0)):void 0}},usernameMinLength:function(t){var e=function(t){return ngettext("Username must be at least %(limit_value)s character long.","Username must be at least %(limit_value)s characters long.",t)};return this.minLength(t.username_length_min,e)},usernameMaxLength:function(t){var e=function(t){return ngettext("Username cannot be longer than %(limit_value)s character.","Username cannot be longer than %(limit_value)s characters.",t)};return this.maxLength(t.username_length_max,e)},usernameContent:function(){return function(t){return n.test($.trim(t))?void 0:gettext("Username can only contain latin alphabet letters and digits.")}},passwordMinLength:function(t){var e=function(t){return ngettext("Valid password must be at least %(limit_value)s character long.","Valid password must be at least %(limit_value)s characters long.",t)};return this.minLength(t.password_length_min,e)}};var o=function(e,n){var o=t.validators.required()(e),i=[];if(o)return[o];for(var r in n)o=n[r](e),o&&i.push(o);return i.length?i:!0},i=function(t){var e={},n=null,i=!0;for(var r in t.validation)t.validation.hasOwnProperty(r)&&(n=t[r](),e[r]=o(t[r](),t.validation[r]),e[r]!==!0&&(i=!1));return t.errors=e,i},r=function(t,e){return e?function(n){var i=null;return"undefined"!=typeof n?(i=o(n,t.validation[e]),i&&(t.errors||(t.errors={}),t.errors[e]=i),t[e](n),t[e](n)):t[e]()}:i(t)};t.addService("validate",{factory:function(){return r}})}(Misago.prototype),function(t){"use strict";var e=function(t){this.included=!1,this.scorePassword=function(t,e){return zxcvbn(t,e).score},this.include=function(){t.include("misago/js/zxcvbn.js"),this.included=!0};var e=function(n){"undefined"!=typeof zxcvbn?n.resolve():t.runloop.runOnce(function(){e(n)},"loading-zxcvbn",150)},n=m.deferred();this.load=function(){return this.included||this.include(),e(n),n.promise}};t.addService("zxcvbn",function(t){return new e(t)},{after:"include"})}(Misago.prototype),function(t){"use strict";var e=function(t){this.message={html:t.message.html,plain:t.message.plain},this.expires_on=t.expires_on},n=function(e){return e.expires_on=t.deserializeDatetime(e.expires_on),e};t.addService("model:ban",function(t){t.models.add("ban",{"class":e,deserialize:n})},{after:"models"})}(Misago.prototype),function(t){"use strict";var e=function(t){this.title=t.title,this.body=t.body,this.link=t.link};t.addService("model:legal-page",function(t){t.models.add("legal-page",{"class":e})},{after:"models"})}(Misago.prototype),function(t){"use strict";var e=function(t){this.id=t.id,this.name=t.name,this.slug=t.slug,this.description=t.description,this.title=t.title,this.css_class=t.css_class,this.is_tab=t.is_tab};t.addService("model:rank",function(t){t.models.add("rank",{"class":e})},{after:"models"})}(Misago.prototype),function(t){"use strict";var e=function(t){this.id=t.id,this.isAuthenticated=!!this.id,this.isAnonymous=!this.isAuthenticated,this.username=t.username,this.slug=t.slug,this.email=t.email,this.full_title=t.full_title,this.rank=t.rank,this.avatar_hash=t.avatar_hash,this.acl=t.acl,this.absolute_url=t.absolute_url},n=function(e,n){return e.joined_on&&(e.joined_on=t.deserializeDatetime(e.joined_on)),e.rank&&(e.rank=n.deserialize("rank",e.rank)),e};t.addService("model:user",function(t){t.models.add("user",{"class":e,deserialize:n})},{after:"model:rank"})}(Misago.prototype),function(t){"use strict";function e(t,e,n){n.retain=!0}var n={classes:{info:"alert-info",success:"alert-success",warning:"alert-warning",error:"alert-danger"},view:function(t,n){var o={config:e,"class":n.alert.isVisible?"in":"out"};return m(".alerts",o,m("p.alert",{"class":this.classes[n.alert.type]},n.alert.message))}};t.addService("component:alert",function(t){t.component("alert",n)},{after:"components"})}(Misago.prototype),function(t){"use strict";function e(t,e,n){n.retain=!0}var n={refresh:function(){window.location.reload()},view:function(t,n){var o="",i={config:e,"class":n.auth.isDesynced?"show":null};return n.auth.isDesynced&&(n.auth.newUser&&n.auth.newUser.isAuthenticated?(o=gettext("You have signed in as %(username)s. Please refresh this page before continuing."),o=interpolate(o,{username:n.auth.newUser.username},!0)):(o=gettext("%(username)s, you have been signed out. Please refresh this page before continuing."),o=interpolate(o,{username:n.user.username},!0))),m(".auth-changed-message",i,m("",m(".container",[m("p",o),m("p",[m('button.btn.btn-default[type="button"]',{onclick:this.refresh},gettext("Reload page")),m("span.hidden-xs.hidden-sm.text-muted",gettext("or press F5 key."))])])))}};t.addService("component:auth-changed-message",function(t){t.component("auth-changed-message",n)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={controller:function(t,e){var n=e||t;return e?t:n.models.deserialize("ban",n.context.ban)},view:function(t){var e=null;return e=t.expires_on?t.expires_on.isAfter(moment())?interpolate(gettext("This ban expires %(expires_on)s."),{expires_on:t.expires_on.fromNow()},!0):gettext("This ban has expired."):gettext("This ban is permanent."),m("p",e)}};t.addService("component:ban-expiration-message",function(t){t.component("ban-expiration-message",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={view:function(t,e,n){var o=[];return o.push(e.message.html?m(".lead",m.trust(e.message.html)):m("p.lead",e.message.plain)),o.push(n.component("ban-expiration-message",e)),m(".page.page-error.page-error-banned",m(".container",m(".message-panel",[m(".message-icon",m("span.material-icon","highlight_off")),m(".message-body",o)])))}};t.addService("component:banned-page",function(t){t.component("banned-page",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={view:function(t,e){var n={disabled:e.disabled||e.loading||!1,config:e.config||null,loading:e.loading||!1,type:e.submit?"submit":"button",onclick:e.onclick||null},o='button[type="'+n.type+'"].btn';n.loading&&(o+=".btn-loading"),e.id&&(o+="#"+e.id),o+=e["class"]||"";var i=e.label;return n.loading&&(i=[i,m(".loader-compact",[m(".bounce1"),m(".bounce2"),m(".bounce3")])]),m(o,n,i)}};t.addService("component:button",function(t){t.component("button",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e=["text","password","email"],n={view:function(t,n){var o=".form-group",i=null,r=null,s=n.control.attrs.type,a=n.control.attrs.id,u=a+"_feedback",c=null,l=null,d=n.validationKey&&null!==n.validation;return n.control.attrs["aria-describedby"]="",d&&n.validation[n.validationKey]&&(l=e.indexOf(s)>=0,n.control.attrs["aria-describedby"]=u,n.validation[n.validationKey]===!0?(o+=".has-success",c=[m("span.material-icon.form-control-feedback",{"aria-hidden":"true"},"check"),m("span.sr-only#"+u,gettext("(success)"))]):(o+=".has-error",i=n.validation[n.validationKey],c=[m("span.material-icon.form-control-feedback",{"aria-hidden":"true"},"clear"),m("span.sr-only#"+u,gettext("(error)"))])),n.helpText&&(r="string"==typeof n.helpText||n.helpText instanceof String?m("p.help-block",n.helpText):n.helpText),m(o,[m("label.control-label"+(n.labelClass||""),{"for":n.labelFor||a},n.label+":"),m(n.controlClass||"",[n.control,l?c:null,i?m(".help-block.errors",i.map(function(t){return m("p",t)})):null,r])])}};t.addService("component:form-group",function(t){t.component("form-group",n)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={view:function(){return m(".loader.sk-folding-cube",[m(".sk-cube1.sk-cube"),m(".sk-cube2.sk-cube"),m(".sk-cube4.sk-cube"),m(".sk-cube3.sk-cube")])}};t.addService("component:loader",function(t){t.component("loader",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e=function(t,e,n){n.retain=!0},n={view:function(t,n){return m("article.misago-markup",{config:e},m.trust(n))}};t.addService("component:markup",function(t){t.component("markup",n)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={view:function(t,e){return m(".modal-header",[m('button.close[type="button"]',{"data-dismiss":"modal","aria-label":gettext("Close")},m("span",{"aria-hidden":"true"},m.trust("&times;"))),m("h4#misago-modal-label.modal-title",e)])}};t.addService("component:modal:header",function(t){t.component("modal:header",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={view:function(t,e){return m(".page-header",m(".container",[m("h1",e.title)]))}};t.addService("component:header",function(t){t.component("header",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e=function(t,e,n){n.retain=!0},n=["progress-bar-danger","progress-bar-warning","progress-bar-warning","progress-bar-primary","progress-bar-success"],o=[gettext("Entered password is very weak."),gettext("Entered password is weak."),gettext("Entered password is average."),gettext("Entered password is strong."),gettext("Entered password is very strong.")],i={view:function(t,i,r){var s=r.zxcvbn.scorePassword(i.password,i.inputs),a={config:e,"class":n[s],style:"width: "+(20+20*s)+"%",role:"progressbar","aria-valuenow":s,"aria-valuemin":"0","aria-valuemax":"4"};return m(".help-block.password-strength",{key:"password-strength"},[m(".progress",m(".progress-bar",a,m("span.sr-only",o[s]))),m("p.text-small",o[s])])}};t.addService("component:password-strength",function(t){t.component("password-strength",i)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={defaultSize:100,src:function(t,e,n){var o=n.baseUrl+"user-avatar/";return o+=t&&t.id?t.avatar_hash+"/"+e+"/"+t.id+".png":e+".png"},view:function(t,e,n,o){var i=n||this.defaultSize;return m("img",{alt:e&&e.username?e.username:gettext("Unregistered"),width:i,height:i,src:this.src(e,i,o)})}};t.addService("component:user-avatar",function(t){t.component("user-avatar",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e=function(e,n){var o=this;this.email=m.prop(""),this.validation={email:[t.validators.email()]},this.clean=function(){return n.validate(this)?!0:(n.alert.error(gettext("Enter a valid email address.")),!1)},this.submit=function(){n.ajax.post(e.api,{email:o.email()}).then(function(t){o.success(t)},function(t){o.error(t)})},this.success=function(t){e.success(t)},this.error=function(t){400===t.status?e.error(t,n):n.ajax.error(t)},this.reset=function(){this.email(""),e.reset()}};t.addService("form:request-link",function(t){t.form("request-link",e)},{after:"forms"})}(Misago.prototype),function(t){"use strict";var e=".well.well-form.well-form-request-activation-link",n=function(t){this.api=t,this.user=null,this.success=function(t){this.user=t},this.error=function(t,e){"already_active"===t.code?(e.alert.info(t.detail),e.modal("sign-in")):"inactive_admin"===t.code?e.alert.info(t.detail):e.alert.error(t.detail)},this.reset=function(){this.user=null}},o={controller:function(t){var e=new n(t.context.SEND_ACTIVATION_API);return{vm:e,form:t.form("request-link",e)}},view:function(t,e){return t.vm.user?this.done(t.vm,t.form,e):this.form(t.form,e)},done:function(t,n,o){var i=gettext("Activation link sent to %(email)s.");return m(e+".well-done",m(".done-message",[m(".message-icon",m("span.material-icon","check")),m(".message-body",m("p",interpolate(i,{email:t.user.email},!0))),o.component("button",{"class":".btn-default.btn-block",submit:!1,label:gettext("Request another link"),onclick:n.reset.bind(n)})]))},form:function(n,o){return m(e,m("form",{onsubmit:n.submit},[m(".form-group",m(".control-input",t.input({disabled:n.isBusy,value:n.email,placeholder:gettext("Your e-mail address")}))),o.component("button",{"class":".btn-primary.btn-block",submit:!0,loading:n.isBusy,label:gettext("Send link")})]))}};t.addService("component:request-activation-link-form",function(t){t.component("request-activation-link-form",o)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={controller:function(t,e){return e.title.set(gettext("Your password has been changed.")),{showSignIn:function(){e.modal("sign-in")}}},view:function(t,e){var n='button.btn.btn-primary[type="button"]',o=gettext("%(username)s, your password has been changed successfully.");return m(".page.page-message.page-message-success.page-forgotten-password-done",m(".container",m(".message-panel",[m(".message-icon",m("span.material-icon","check")),m(".message-body",[m("p.lead",interpolate(o,{username:e.username},!0)),m("p",gettext("You will have to sign in using new password before continuing.")),m("p",m(n,{onclick:t.showSignIn},gettext("Sign in")))])])))}};t.addService("component:forgotten-password:done-page",function(t){t.component("forgotten-password:done-page",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={view:function(t,e,n){var o=null;return"inactive_user"===e.type&&(o=m("p",m("a",{href:n.context.REQUEST_ACTIVATION_URL},gettext("Activate your account.")))),m(".page.page-message.page-message-info.page-forgotten-password-inactive",m(".container",m(".message-panel",[m(".message-icon",m("span.material-icon","info_outline")),m(".message-body",[m("p.lead",gettext("Your account is inactive.")),m("p",e.message),o])])))}};t.addService("component:forgotten-password:inactive-page",function(t){t.component("forgotten-password:inactive-page",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e=".well.well-form.well-form-request-password-reset-link",n=function(t){this.api=t,this.user=null,this.activation=null,this.activationMessage=null,this.success=function(t){this.user=t},this.error=function(t,e){if(["inactive_user","inactive_admin"].indexOf(t.code)>-1){var n=e.component("forgotten-password:inactive-page",{type:t.code,message:t.detail});e.mountPage(n)}else e.alert.error(t.detail)},this.reset=function(){this.user=null,this.activation=null,this.activationMessage=null}},o={controller:function(t){var e=new n(t.context.SEND_PASSWORD_RESET_API);return{vm:e,form:t.form("request-link",e)}},view:function(t,e){return t.vm.user?this.done(t.vm,t.form,e):this.form(t.form,e)},done:function(t,n,o){var i=gettext("Reset password link sent to %(email)s.");return m(e+".well-done",m(".done-message",[m(".message-icon",m("span.material-icon","check")),m(".message-body",m("p",interpolate(i,{
email:t.user.email},!0))),o.component("button",{"class":".btn-default.btn-block",submit:!1,label:gettext("Request another link"),onclick:n.reset.bind(n)})]))},form:function(n,o){return m(e,m("form",{onsubmit:n.submit},[m(".form-group",m(".control-input",t.input({disabled:n.isBusy,value:n.email,placeholder:gettext("Your e-mail address")}))),o.component("button",{"class":".btn-primary.btn-block",submit:!0,loading:n.isBusy,label:gettext("Send link")})]))}};t.addService("component:forgotten-password:request-link",function(t){t.component("forgotten-password:request-link",o)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e=".well.well-form.well-form-reset-password",n=function(t){this.api=t,this.success=function(t,e){e.auth.signOut(),e.mountPage(e.component("forgotten-password:done-page",t))}},o={controller:function(t){var e=new n(t.context.CHANGE_PASSWORD_API);return{form:t.form("reset-password",e)}},view:function(n,o){return m(e,m("form",{onsubmit:n.form.submit},[m(".form-group",m(".control-input",t.input({disabled:n.form.isBusy,value:n.form.password,type:"password",placeholder:gettext("Enter new password")}))),o.component("button",{"class":".btn-primary.btn-block",submit:!0,loading:n.form.isBusy,label:gettext("Change password")})]))}};t.addService("component:forgotten-password:reset-password",function(t){t.component("forgotten-password:reset-password",o)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e=function(e,n){var o=this;this.password=m.prop(""),this.validation={password:[t.validators.passwordMinLength(n.settings)]},this.clean=function(){return n.validate(this)?!0:(n.alert.error($.trim(this.password()).length?this.errors.password:gettext("Enter new password.")),!1)},this.submit=function(){n.ajax.post(e.api,{password:o.password()}).then(function(t){o.success(t)},function(t){o.error(t)})},this.success=function(t){e.success(t,n)},this.error=function(t){n.ajax.error(t)}};t.addService("form:reset-password",function(t){t.form("reset-password",e)},{after:"forms"})}(Misago.prototype),function(t){"use strict";var e={controller:function(t){return{openUserMenu:function(){t.dropdown.toggle("navbar-dropdown","navbar:dropdown:guest")}}},view:function(t,e){return m("button",{type:"button",onclick:t.openUserMenu},e.component("user-avatar",null,64))}};t.addService("component:navbar:compact:guest-nav",function(t){t.component("navbar:compact:guest-nav",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={controller:function(t){return{openUserMenu:function(){return t.dropdown.toggle("navbar-dropdown","navbar:dropdown:user"),!1}}},view:function(t,e){var n={onclick:t.openUserMenu,href:e.user.absolute_url};return m("a",n,e.component("user-avatar",e.user,64))}};t.addService("component:navbar:compact:user-nav",function(t){t.component("navbar:compact:user-nav",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={controller:function(t){return{showSignIn:function(){t.modal("sign-in")}}},view:function(t,e){return m("div.nav.nav-guest",[e.component("button",{"class":".navbar-btn.btn-default",onclick:t.showSignIn,disabled:t.isBusy,label:gettext("Sign in")}),e.component("navbar:register-button",".navbar-btn.btn-primary")])}};t.addService("component:navbar:desktop:guest-nav",function(t){t.component("navbar:desktop:guest-nav",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={controller:function(t){return{dropdownToggle:{href:t.user.absolute_url,"data-toggle":"dropdown","data-misago-routed":"false","aria-haspopup":"true","aria-expanded":"false"}}},view:function(t,e){return m("ul.nav.navbar-nav.nav-user",[m("li.dropdown",[m('a.dropdown-toggle[role="button"]',t.dropdownToggle,e.component("user-avatar",e.user,64)),e.component("navbar:dropdown:user")])])}};t.addService("component:navbar:desktop:user-nav",function(t){t.component("navbar:desktop:user-nav",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={controller:function(t){return{showSignIn:function(){t.modal("sign-in")}}},view:function(t,e){return m('ul.dropdown-menu.user-dropdown.dropdown-menu-right[role="menu"]',m("li.guest-preview",[m("h4",gettext("You are browsing as guest.")),m("p",gettext("Sign in or register to start and participate in discussions.")),m(".row",[m(".col-xs-6",e.component("button",{"class":".btn.btn-default.btn-block",onclick:t.showSignIn,disabled:t.isBusy,label:gettext("Sign in")})),m(".col-xs-6",e.component("navbar:register-button",".btn.btn-primary.btn-block"))])]))}};t.addService("component:navbar:dropdown:guest",function(t){t.component("navbar:dropdown:guest",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={controller:function(t,e){return{isBusy:!1,showRegister:function(){if("closed"===e.settings.account_activation)e.alert.info(gettext("New registrations are currently disabled."));else{m.startComputation(),this.isBusy=!0,m.endComputation();var t=this;m.sync([e.zxcvbn.load(),e.captcha.load()]).then(function(){e.modal("register")},function(){e.alert.error(gettext("Registation is not available now due to an error."))}).then(function(){m.startComputation(),t.isBusy=!1,m.endComputation()})}}}},view:function(t,e,n){return n.component("button",{"class":e,onclick:t.showRegister.bind(t),loading:t.isBusy,label:gettext("Register")})}};t.addService("component:navbar:register-button",function(t){t.component("navbar:register-button",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e={"class":".dropdown-menu.user-dropdown.dropdown-menu-right",controller:function(){return{logout:function(){var t=confirm(gettext("Are you sure you want to sign out?"));t&&$("#hidden-logout-form").submit()}}},view:function(t,e){return m("ul"+this["class"]+'[role="menu"]',[m("li.dropdown-header",m("strong",e.user.username)),m("li.divider"),m("li",m("a",{href:e.user.absolute_url},[m("span.material-icon","account_circle"),gettext("See your profile")])),m("li",m("a",{href:e.context.USERCP_URL},[m("span.material-icon","done_all"),gettext("Change options")])),m("li",m('button.btn-link[type="button"]',[m("span.material-icon","face"),gettext("Change avatar")])),m("li.divider"),m("li.dropdown-footer",m("button.btn.btn-default.btn-block",{onclick:t.logout},gettext("Logout")))])}};t.addService("component:navbar:dropdown:user",function(t){t.component("navbar:dropdown:user",e)},{after:"components"})}(Misago.prototype),function(t){"use strict";var e=function(t,e,n){n.retain=!0},n=function(){document.location.reload()},o={controller:function(t,e){"active"===t.activation&&e.runloop.runOnce(n,"refresh-after-registration",1e4)},view:function(t,n,o){var i=null;return i="active"===n.activation?this.active(n):this.inactive(n),m('.modal-dialog.modal-message.modal-register[role="document"]',{config:e},m(".modal-content",[o.component("modal:header",gettext("Registration complete")),m(".modal-body",i)]))},active:function(t){var e=gettext("%(username)s, your account has been created and you were signed in.");return[m(".message-icon",m("span.material-icon","check")),m(".message-body",[m("p.lead",interpolate(e,{username:t.username},!0)),m("p",gettext("The page will refresh automatically in 10 seconds.")),m("p",m('button[type="button"].btn.btn-default',{onclick:n},gettext("Refresh page")))])]},inactive:function(t){var e=null,n=null;return"user"===t.activation?(e=gettext("%(username)s, your account has been created but you need to activate it before you will be able to sign in."),n=gettext("We have sent an e-mail to %(email)s with link that you have to click to activate your account.")):"admin"===t.activation&&(e=gettext("%(username)s, your account has been created but board administrator will have to activate it before you will be able to sign in."),n=gettext("We will send an e-mail to %(email)s when this takes place.")),[m(".message-icon",m("span.material-icon","info_outline")),m(".message-body",[m("p.lead",interpolate(e,{username:t.username},!0)),m("p",interpolate(n,{email:t.email},!0))])]}};t.addService("modal:register:complete",function(t){t.modal("register:complete",o)},{after:"modals"})}(Misago.prototype),function(t){"use strict";var e=function(t,e,n){n.retain=!0},n={controller:function(t){return{form:t.form("register")}},view:function(t,n){var o=n.captcha.component({form:t.form,labelClass:".col-md-4",controlClass:".col-md-8"}),i=null;return n.context.TERMS_OF_SERVICE_URL&&(i=m("a",{href:n.context.TERMS_OF_SERVICE_URL},m.trust(interpolate(gettext("By registering you agree to site's %(terms)s."),{terms:"<strong>"+gettext("terms and conditions")+"</strong>"},!0)))),m('.modal-dialog.modal-form.modal-register[role="document"]',{config:e},m(".modal-content",[n.component("modal:header",gettext("Register")),m("form.form-horizontal",{onsubmit:t.form.submit},[m('input[type="text"]',{name:"_username",style:"display: none"}),m('input[type="password"]',{name:"_password",style:"display: none"}),m(".modal-body",[n.component("form-group",{label:gettext("Username"),labelClass:".col-md-4",controlClass:".col-md-8",control:n.input({value:n.validate(t.form,"username"),id:"id_username",disabled:t.form.isBusy}),validation:t.form.errors,validationKey:"username"}),n.component("form-group",{label:gettext("E-mail"),labelClass:".col-md-4",controlClass:".col-md-8",control:n.input({value:n.validate(t.form,"email"),id:"id_email",disabled:t.form.isBusy}),validation:t.form.errors,validationKey:"email"}),n.component("form-group",{label:gettext("Password"),labelClass:".col-md-4",controlClass:".col-md-8",control:n.input({value:n.validate(t.form,"password"),type:"password",id:"id_password",disabled:t.form.isBusy}),validation:t.form.errors,validationKey:"password",helpText:n.component("password-strength",{inputs:[t.form.username(),t.form.email()],password:t.form.password()})}),o]),m(".modal-footer",[i,n.component("button",{"class":".btn-primary",submit:!0,loading:t.form.isBusy,label:gettext("Register account")})])])]))}};t.addService("modal:register",function(t){t.modal("register",n)},{after:"modals"})}(Misago.prototype),function(t){"use strict";var e=function(e){var n=this;this.showActivation=!1,this.username=m.prop(""),this.email=m.prop(""),this.password=m.prop(""),this.captcha=e.captcha.value,this.errors=null,this.validation={username:[t.validators.usernameContent(),t.validators.usernameMinLength(e.settings),t.validators.usernameMaxLength(e.settings)],email:[t.validators.email()],password:[t.validators.passwordMinLength(e.settings)],captcha:e.captcha.validator()},this.clean=function(){return null===this.errors&&e.validate(this),e.captcha.clean(this),this.hasErrors()?(e.alert.error(gettext("Form contains errors.")),!1):!0},this.submit=function(){e.ajax.post(e.context.USERS_API,{username:this.username(),email:this.email(),password:this.password(),captcha:this.captcha()}).then(this.success,this.error)},this.success=function(t){e.modal("register:complete",t)},this.error=function(t){400===t.status?(e.alert.error(gettext("Form contains errors.")),$.extend(n.errors,t)):e.ajax.error(t)}};t.addService("form:register",function(t){t.form("register",e)},{after:"forms"})}(Misago.prototype),function(t){"use strict";var e=function(t){var e=this;this.showActivation=!1,this.username=m.prop(""),this.password=m.prop(""),this.validation={username:[],password:[]},this.clean=function(){return t.validate(this)?!0:(t.alert.error(gettext("Fill out both fields.")),!1)},this.submit=function(){t.ajax.post(t.context.AUTH_API,{username:e.username(),password:e.password()}).then(function(){e.success()},function(t){e.error(t)})},this.success=function(){t.modal();var e=$("#hidden-login-form");t.ajax.refreshCsrfToken(),e.append('<input type="text" name="username" />'),e.append('<input type="password" name="password" />'),e.find('input[type="hidden"]').val(t.ajax.csrfToken),e.find('input[name="redirect_to"]').val(window.location.pathname),e.find('input[name="username"]').val(this.username()),e.find('input[name="password"]').val(this.password()),e.submit()},this.error=function(n){400===n.status?"inactive_admin"===n.code?t.alert.info(n.detail):"inactive_user"===n.code?(t.alert.info(n.detail),e.showActivation=!0):"banned"===n.code?(t.showBannedPage(n.detail),t.modal()):t.alert.error(n.detail):t.ajax.error(n)}};t.addService("form:sign-in",function(t){t.form("sign-in",e)},{after:"forms"})}(Misago.prototype),function(t){"use strict";function e(t,e,n){n.retain=!0}var n={controller:function(t){return{form:t.form("sign-in")}},view:function(n,o){var i=null;return n.form.showActivation&&(i=m("a.btn.btn-block.btn-success",{href:o.context.REQUEST_ACTIVATION_URL},gettext("Activate account"))),m('.modal-dialog.modal-sm.modal-signin[role="document"]',{config:e},m(".modal-content",[o.component("modal:header",gettext("Sign in")),m("form",{onsubmit:n.form.submit},[m(".modal-body",[m(".form-group",m(".control-input",t.input({disabled:n.form.isBusy,value:n.form.username,placeholder:gettext("Username or e-mail")}))),m(".form-group",m(".control-input",t.input({type:"password",disabled:n.form.isBusy,value:n.form.password,placeholder:gettext("Password")})))]),m(".modal-footer",[i,o.component("button",{"class":".btn-primary.btn-block",submit:!0,loading:n.form.isBusy,label:gettext("Sign in")}),m("a.btn.btn-block.btn-default",{href:o.context.FORGOTTEN_PASSWORD_URL},gettext("Forgot password?"))])])]))}};t.addService("modal:sign-in",function(t){t.modal("sign-in",n)},{after:"modals"})}(Misago.prototype);
//# sourceMappingURL=/misago.js.map