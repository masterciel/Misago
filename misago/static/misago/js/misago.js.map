{"version":3,"sources":["misago.js"],"names":["window","Misago","ns","Object","getPrototypeOf","this","self","preloaded_data","SETTINGS","_services","addService","name","factory","order","push","item","after","get","before","_initServices","services","ordered_services","OrderedList","forEach","undefined","service_instance","_destroyServices","reverse","destroy","registerCoreServices","Conf","ComponentFactory","RouterFactory","Api","Outlet","PageTitle","startRouting","setup","init","fixture","in_test","persistent","el","isInit","context","retain","ForumLayout","view","ctrl","_","component","ForumNavbar","m","config","ForumFooter","prototype","controller","container","setTitle","settings","forum_index_title","IndexPage","legalPageFactory","type_name","default_title","dashed_type_name","replace","is_destroyed","location","vm","onunload","is_busy","is_ready","content","title","api","one","then","data","body","redraw","PageHeader","trust","LoadingPage","TermsOfServicePage","gettext","PrivacyPolicyPage","Loader","setupMarkup","MisagoMarkup","options","legalLink","legal_type","url","router","href","FooterNav","isVisible","forum_footnote","terms_of_service","terms_of_service_link","privacy_policy","privacy_policy_link","indexOf","items","nav","FooterMisagoBranding","BrandFull","branding","children","src","staticUrl","alt","forum_name","desktop_navbar","forum_branding_display","forum_branding_text","route","cookie_regex","RegExp","CSRF_COOKIE_NAME","csrf_token","document","cookie","match","split","ajax","method","progress","deferred","ajax_settings","headers","X-CSRFToken","dataType","success","resolve","error","jqXHR","reject","$","promise","pop","post","buildUrl","model","call","querystrings","base_url","id","many","filters","target","arguments_array","i","arguments","length","apply","mount","getElementById","Router","attr","static_url","media_url","urls","reverses","populatePatterns","urlconf","patterns","final_pattern","pattern","mode","delegate_element","delegate_name","cleanUrl","is_relative","substr","protocol","host","avatars_url","delegateClicks","element","on","e","clean_url","preventDefault","off","prefixUrl","prefix","mediaUrl","_setTitle","complete_title","page","interpolate","parent","has","obj","key","hasOwnProperty","value","returnValue","is_ordered","_items","add","values","values_only","_order","unordered","insertItem","insertAt","ordering","ordered","splice","index","iterations","startsWith","string","beginning","endsWith","tail","UrlConfInvalidComponentError","message","UrlConf","_patterns","prefixPattern","include","loadingPage"],"mappings":"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","file":"misago.js","sourcesContent":["/* global -Misago */\n/* exported Misago */\n(function () {\n  'use strict';\n\n  window.Misago = function() {\n\n    var ns = Object.getPrototypeOf(this);\n    var self = this;\n\n    // Preloaded data\n    this.preloaded_data = {\n      // Empty settings\n      SETTINGS: {}\n    };\n\n    // Services\n    this._services = [];\n    this.addService = function(name, factory, order) {\n      this._services.push({\n        name: name,\n        item: factory,\n        after: this.get(order, 'after'),\n        before: this.get(order, 'before')\n      });\n    };\n\n    this._initServices = function(services) {\n      var ordered_services = new ns.OrderedList(services).order(false);\n      ordered_services.forEach(function (item) {\n        var factory = null;\n        if (item.item.factory !== undefined) {\n          factory = item.item.factory;\n        } else {\n          factory = item.item;\n        }\n\n        var service_instance = factory(self);\n        if (service_instance) {\n          self[item.name] = service_instance;\n        }\n      });\n    };\n\n    this._destroyServices = function(services) {\n      var ordered_services = new ns.OrderedList(services).order();\n      ordered_services.reverse();\n      ordered_services.forEach(function (item) {\n        if (item.destroy !== undefined) {\n          item.destroy(self);\n        }\n      });\n    };\n\n    this.registerCoreServices = function() {\n      this.addService('conf', ns.Conf);\n      this.addService('component', ns.ComponentFactory);\n      this.addService('router', ns.RouterFactory);\n      this.addService('api', ns.Api);\n      this.addService('outlet', ns.Outlet);\n      this.addService('title', ns.PageTitle);\n      this.addService('start-routing', ns.startRouting);\n    };\n\n    // App init/destory\n    this.setup = false;\n    this.init = function(setup) {\n      this.setup = {\n        fixture: ns.get(setup, 'fixture', null),\n        in_test: ns.get(setup, 'in_test', false)\n      };\n\n      this._initServices(this._services);\n    };\n\n    this.destroy = function() {\n      this._destroyServices();\n    };\n  };\n}());\n\n\n(function (ns) {\n  'use strict';\n\n  var persistent = function(el, isInit, context) {\n    context.retain = true;\n  };\n\n  ns.ForumLayout = {\n    view: function(ctrl, _) {\n      return [\n        _.component(ns.ForumNavbar),\n        m('#router-fixture', {config: persistent}),\n        _.component(ns.ForumFooter)\n      ];\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  var self = {\n    controller: function() {\n      var _ = self.container;\n      _.setTitle(_.settings.forum_index_title);\n    },\n    view: function() {\n      return m('.container', [\n        m('h1', 'Forum index page!'),\n        m('p', 'Lorem ipsum dolor met sit amet elit.'),\n        m('p', 'Sequar elit dolor nihi putto.')\n      ]);\n    }\n  };\n  ns.IndexPage = self;\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  var legalPageFactory = function(type_name, default_title) {\n    var dashed_type_name = type_name.replace(/_/g, '-');\n\n    var self = {\n      is_destroyed: true,\n      controller: function() {\n        var _ = self.container;\n        self.is_destroyed = false;\n\n        if (ns.get(_.settings, type_name + '_link')) {\n          window.location = ns.get(_.settings, type_name + '_link');\n        } else {\n          self.vm.init(_);\n        }\n\n        return {\n          onunload: function() {\n            self.is_destroyed = true;\n          }\n        };\n      },\n      vm: {\n        is_busy: false,\n        is_ready: false,\n        content: null,\n\n        init: function(_) {\n\n          var vm = this;\n          if (vm.is_ready) {\n            _.setTitle(vm.title);\n          } else {\n            _.setTitle();\n\n            if (!vm.is_busy) {\n              vm.is_busy = true;\n\n              _.api.one('legal-pages', dashed_type_name).then(function(data) {\n                vm.title = data.title || default_title;\n                vm.body = data.body;\n                vm.is_busy = false;\n                vm.is_ready = true;\n\n                if (!self.is_destroyed) {\n                  _.setTitle(vm.title);\n                  m.redraw();\n                }\n              });\n            }\n          }\n        }\n      },\n      view: function() {\n        var _ = this.container;\n\n        if (this.vm.is_ready) {\n          return m('.page.page-legal.page-legal-' + dashed_type_name, [\n            _.component(ns.PageHeader, {title: this.vm.title}),\n            m('.container',\n              m.trust(this.vm.body)\n            )\n          ]);\n        } else {\n          return _.component(ns.LoadingPage);\n        }\n      }\n    };\n    return self;\n  };\n\n  ns.TermsOfServicePage = legalPageFactory(\n    'terms_of_service', gettext('Terms of service'));\n  ns.PrivacyPolicyPage = legalPageFactory(\n    'privacy_policy', gettext('Privacy policy'));\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.Loader = {\n    view: function() {\n      return m('.loader.sk-folding-cube', [\n        m('.sk-cube1.sk-cube'),\n        m('.sk-cube2.sk-cube'),\n        m('.sk-cube4.sk-cube'),\n        m('.sk-cube3.sk-cube')\n      ]);\n    }\n  };\n\n  ns.LoadingPage = {\n    view: function(ctrl, _) {\n      return m('.page.page-loading',\n        _.component(ns.Loader)\n      );\n    }\n  };\n} (Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  var setupMarkup = function(el, isInit, context) {\n    context.retain = true;\n  };\n\n  ns.MisagoMarkup = {\n    view: function(ctrl, content) {\n      return m('article.misago-markup', {config: setupMarkup}, m.trust(content));\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.PageHeader = {\n    view: function(ctrl, options) {\n      return m('.page-header',\n        m('.container', [\n          m('h1', options.title),\n        ])\n      );\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  var legalLink = function(_, legal_type, default_title) {\n    var url = ns.get(_.settings, legal_type + '_link');\n    if (!url && ns.get(_.settings, legal_type)) {\n      url = _.router.url(legal_type);\n    }\n\n    if (url) {\n      return m('li',\n        m('a', {href: url}, ns.get(_.settings, legal_type + '_title', default_title))\n      );\n    } else {\n      return null;\n    }\n  };\n\n  ns.FooterNav = {\n    isVisible: function(settings) {\n      return [\n        !!settings.forum_footnote,\n        !!settings.terms_of_service,\n        !!settings.terms_of_service_link,\n        !!settings.privacy_policy,\n        !!settings.privacy_policy_link\n      ].indexOf(true) !== -1;\n    },\n    view: function(ctrl, _) {\n      var items = [];\n\n      if (_.settings.forum_footnote) {\n        items.push(m('li.forum-footnote', m.trust(_.settings.forum_footnote)));\n      }\n\n      items.push(legalLink(_, 'terms_of_service', gettext('Terms of service')));\n      items.push(legalLink(_, 'privacy_policy', gettext('Privacy policy')));\n\n      return m('ul.list-inline.footer-nav', items);\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.ForumFooter = {\n    view: function(ctrl, _) {\n      var nav = null;\n      if (ns.FooterNav.isVisible(_.settings)) {\n        nav = _.component(ns.FooterNav);\n      }\n\n      return m('footer.forum-footer', [\n        m('.container',\n          m('.footer-content', [\n            nav,\n            _.component(ns.FooterMisagoBranding)\n          ])\n        )\n      ]);\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.FooterMisagoBranding = {\n    view: function() {\n      return m('a.misago-branding[href=http://misago-project.org]', [\n        \"powered by \", m('strong', \"misago\")\n      ]);\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.BrandFull = {\n    view: function(ctrl, branding, _) {\n      var children = [\n        m('img', {\n          src: _.router.staticUrl('misago/img/site-logo.png'),\n          alt: _.settings.forum_name\n        })\n      ];\n\n      if (branding) {\n        children.push(branding);\n      }\n\n      return m('a.navbar-brand', {href: _.router.url('index')}, children);\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.ForumNavbar = {\n    view: function(ctrl, _) {\n      var desktop_navbar = [];\n\n      if (_.settings.forum_branding_display) {\n        desktop_navbar.push(_.component(ns.BrandFull, _.settings.forum_branding_text));\n      }\n\n      desktop_navbar.push(m('ul.nav.navbar-nav', [\n        m('li', m(\"a\", {config: m.route, href: _.router.url('index')}, 'Index')),\n        m('li', m(\"a\", {config: m.route, href: _.router.url('test')}, 'Test'))\n      ]));\n\n      return m('nav.navbar.navbar-default.navbar-static-top[role=\"navigation\"]', [\n        m('.container.navbar-full.hidden-xs.hidden-sm', desktop_navbar)\n      ]);\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  var Api = function(_) {\n    // Ajax implementation\n    var cookie_regex = new RegExp(_.preloaded_data.CSRF_COOKIE_NAME + '\\=([^;]*)');\n    this.csrf_token = ns.get(document.cookie.match(cookie_regex), 0).split('=')[1];\n\n    this.ajax = function(method, url, data, progress) {\n      var deferred = m.deferred();\n\n      var ajax_settings = {\n        url: url,\n        method: method,\n        headers: {\n          'X-CSRFToken': this.csrf_token\n        },\n\n        data: data | {},\n        dataType: 'json',\n\n        success: function(data) {\n          deferred.resolve(data);\n        },\n        error: function(jqXHR) {\n          deferred.reject(jqXHR);\n        }\n      };\n\n      if (progress) {\n        return; // not implemented... yet!\n      }\n\n      $.ajax(ajax_settings);\n      return deferred.promise;\n    };\n\n    this.get = function(url) {\n      var preloaded_data = ns.pop(_.preloaded_data, url);\n      if (preloaded_data) {\n        var deferred = m.deferred();\n        deferred.resolve(preloaded_data);\n        return deferred.promise;\n      } else {\n        return this.ajax('GET', url);\n      }\n    };\n\n    this.post = function(url) {\n      return this.ajax('POST', url);\n    };\n\n    // API\n    this.buildUrl = function(model, call, querystrings) {\n      var url = _.router.base_url;\n      url += 'api/' + model + '/';\n      return url;\n    };\n\n    this.one = function(model, id) {\n      var url = this.buildUrl(model) + id + '/';\n      return this.get(url);\n    };\n\n    this.many = function(model, filters) {\n\n    };\n\n    this.call = function(model, target, call, data) {\n\n    };\n  };\n\n  ns.Api = function(_) {\n    return new Api(_);\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.ComponentFactory = function(_) {\n    // Component factory\n    _.component = function() {\n      var arguments_array = [];\n      for (var i = 0; i < arguments.length; i += 1) {\n        arguments_array.push(arguments[i]);\n      }\n\n      arguments_array.push(_);\n      return m.component.apply(undefined, arguments_array);\n    };\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.Conf = function(_) {\n    _.settings = ns.get(_.preloaded_data, 'SETTINGS', {});\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.Outlet = {\n    factory: function(_) {\n      if (_.setup.fixture) {\n        m.mount(document.getElementById(_.setup.fixture),\n                _.component(ns.ForumLayout));\n      }\n    },\n\n    destroy: function(_) {\n      if (_.setup.fixture) {\n        m.mount(_.setup.fixture, null);\n      }\n    }\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  var Router = function(_) {\n    var self = this;\n    this.base_url = $('base').attr('href');\n\n    this.static_url = ns.get(_.preloaded_data, 'STATIC_URL', '/');\n    this.media_url = ns.get(_.preloaded_data, 'MEDIA_URL', '/');\n\n    // Routing\n    this.urls = {};\n    this.reverses = {};\n\n    var populatePatterns = function(urlconf) {\n      urlconf.patterns().forEach(function(url) {\n        // set service container on component\n        url.component.container = _;\n\n        var final_pattern = self.base_url + url.pattern;\n        final_pattern = final_pattern.replace('//', '/');\n\n        self.urls[final_pattern] = url.component;\n        self.reverses[url.name] = final_pattern;\n      });\n    };\n\n    this.startRouting = function(urlconf, fixture) {\n      populatePatterns(urlconf);\n      this.fixture = fixture;\n\n      m.route.mode = 'pathname';\n      m.route(fixture, '/', this.urls);\n    };\n\n    this.url = function(name) {\n      return this.reverses[name];\n    };\n\n    // Delegate clicks\n    this.delegate_element = null;\n    this.delegate_name = 'click.misago-router';\n\n    this.cleanUrl = function(url) {\n      if (!url) { return; }\n\n      // Is link relative?\n      var is_relative = url.substr(0, 1) === '/' && url.substr(0, 2) !== '//';\n\n      // If link contains host, validate to see if its outgoing\n      if (!is_relative) {\n        var location = window.location;\n\n        // If protocol matches current one, strip it from string\n        // otherwhise stop handler\n        if (url.substr(0, 2) !== '//') {\n          var protocol = url.substr(0, location.protocol.length + 2);\n          if (protocol !== location.protocol + '//') { return; }\n          url = url.substr(location.protocol.length + 2);\n        } else {\n          url = url.substr(2);\n        }\n\n        // Host checks out?\n        if (url.substr(0, location.host.length) !== location.host) { return; }\n        url = url.substr(location.host.length);\n      }\n\n      // Is link within Ember app?\n      if (url.substr(0, this.base_url.length) !== this.base_url) { return; }\n\n      // Is link to media/static/avatar server?\n      if (url.substr(0, this.static_url.length) === this.static_url) { return; }\n\n      if (url.substr(0, this.media_url.length) === this.media_url) { return; }\n\n      var avatars_url = '/user-avatar/';\n      if (url.substr(0, avatars_url.length) === avatars_url) { return; }\n\n      return url;\n    };\n\n    this.delegateClicks = function(element) {\n      this.delegate_element = element;\n      $(this.delegate_element).on(this.delegate_name, 'a', function(e) {\n        var clean_url = self.cleanUrl(e.target.href);\n        if (clean_url) {\n          if (clean_url != m.route()) {\n            m.route(clean_url);\n          }\n          e.preventDefault();\n        }\n      });\n    };\n\n    this.destroy = function() {\n      $(this.delegate_element).off(this.delegate_name);\n    };\n\n    // Media/Static url\n    var prefixUrl = function(prefix) {\n      return function(url) {\n        return prefix + url;\n      };\n    };\n\n    this.staticUrl = prefixUrl(this.static_url);\n    this.mediaUrl = prefixUrl(this.media_url);\n  };\n\n  ns.RouterFactory = function(_) {\n    return new Router(_);\n  };\n\n  ns.startRouting = function(_) {\n    _.router.startRouting(ns.urls, document.getElementById('router-fixture'));\n    _.router.delegateClicks(document.getElementById(_.setup.fixture));\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.PageTitle = function(_) {\n    _._setTitle = function(title) {\n      if (typeof title === 'string') {\n        title = {title: title};\n      }\n\n      var complete_title = title.title;\n\n      if (typeof title.page !== 'undefined' && title.page > 1) {\n        complete_title += ' (' + interpolate(gettext('page %(page)s'), { page:title.page }, true) + ')';\n      }\n\n      if (typeof title.parent !== 'undefined') {\n        complete_title += ' | ' + title.parent;\n      }\n\n      document.title = complete_title + ' | ' + this.settings.forum_name;\n    };\n\n    _.setTitle = function(title) {\n      if (title) {\n        this._setTitle(title);\n      } else {\n        document.title = this.settings.forum_name;\n      }\n    };\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.has = function(obj, key) {\n    if (obj !== undefined) {\n      return obj.hasOwnProperty(key);\n    } else {\n      return false;\n    }\n  };\n\n  ns.get = function(obj, key, value) {\n    if (ns.has(obj, key)) {\n      return obj[key];\n    } else if (value !== undefined) {\n      return value;\n    } else {\n      return undefined;\n    }\n  };\n\n  ns.pop = function(obj, key, value) {\n    var returnValue = ns.get(obj, key, value);\n    if (ns.has(obj, key)) {\n      delete obj[key];\n    }\n    return returnValue;\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.OrderedList = function(items) {\n    this.is_ordered = false;\n    this._items = items || [];\n\n    this.add = function(key, item, order) {\n      this._items.push({\n        key: key,\n        item: item,\n        after: ns.get(order, 'after'),\n        before: ns.get(order, 'before')\n      });\n    };\n\n    this.get = function(key, value) {\n      for (var i = 0; i < this._items.length; i++) {\n        if (this._items[i].key === key) {\n          return this._items[i].item;\n        }\n      }\n\n      return value;\n    };\n\n    this.has = function(key) {\n      return this.get(key) !== undefined;\n    };\n\n    this.values = function() {\n      var values = [];\n      for (var i = 0; i < this._items.length; i++) {\n        values.push(this._items[i].item);\n      }\n      return values;\n    };\n\n    this.order = function(values_only) {\n      if (!this.is_ordered) {\n        this._items = this._order(this._items);\n        this.is_ordered = true;\n      }\n\n      if (values_only || typeof values_only === 'undefined') {\n        return this.values();\n      } else {\n        return this._items;\n      }\n    };\n\n    this._order = function(unordered) {\n      // Index of unordered items\n      var index = [];\n      unordered.forEach(function (item) {\n        index.push(item.key);\n      });\n\n      // Ordered items\n      var ordered = [];\n      var ordering = [];\n\n      // First pass: register items that\n      // don't specify their order\n      unordered.forEach(function (item) {\n        if (!item.after && !item.before) {\n          ordered.push(item);\n          ordering.push(item.key);\n        }\n      });\n\n      // Second pass: keep iterating items\n      // until we hit iterations limit or finish\n      // ordering list\n      function insertItem(item) {\n        var insertAt = -1;\n        if (ordering.indexOf(item.key) === -1) {\n          if (item.after) {\n            insertAt = ordering.indexOf(item.after);\n            if (insertAt !== -1) {\n              insertAt += 1;\n            }\n          } else if (item.before) {\n            insertAt = ordering.indexOf(item.before);\n          }\n\n          if (insertAt !== -1) {\n            ordered.splice(insertAt, 0, item);\n            ordering.splice(insertAt, 0, item.key);\n          }\n        }\n      }\n\n      var iterations = 200;\n      while (iterations > 0 && index.length !== ordering.length) {\n        iterations -= 1;\n        unordered.forEach(insertItem);\n      }\n\n      return ordered;\n    };\n  };\n} (Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.startsWith = function(string, beginning) {\n    return string.indexOf(beginning) === 0;\n  };\n\n  ns.endsWith = function(string, tail) {\n    return string.indexOf(tail, string.length - tail.length) !== -1;\n  };\n}(Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.UrlConfInvalidComponentError = function() {\n    this.message = 'component argument should be array or object';\n  };\n\n  ns.UrlConf = function() {\n    var self = this;\n    this._patterns = [];\n\n    this.patterns = function() {\n      return this._patterns;\n    };\n\n    var prefixPattern = function(prefix, pattern) {\n      return (prefix + pattern).replace('//', '/');\n    };\n\n    var include = function(prefix, patterns) {\n      for (var i = 0; i < patterns.length; i ++) {\n        self.url(prefixPattern(prefix, patterns[i].pattern),\n                 patterns[i].component,\n                 patterns[i].name);\n      }\n    };\n\n    this.url = function(pattern, component, name) {\n      if (typeof component !== 'object') {\n        throw new ns.UrlConfInvalidComponentError();\n      }\n\n      if (pattern === '') {\n        pattern = '/';\n      }\n\n      if (component instanceof ns.UrlConf) {\n        include(pattern, component.patterns());\n      } else {\n        this._patterns.push({\n          pattern: pattern,\n          component: component,\n          name: name\n        });\n      }\n    };\n  };\n} (Misago.prototype));\n\n(function (ns) {\n  'use strict';\n\n  ns.loadingPage = function(_) {\n    return m('.page.page-loading', _.component(ns.Loader));\n  };\n} (Misago.prototype));\n\n(function (ns, UrlConf) {\n  'use strict';\n\n  var urls = new UrlConf();\n  urls.url('/', ns.IndexPage, 'index');\n\n  // Legal pages\n  urls.url('/terms-of-service/', ns.TermsOfServicePage, 'terms_of_service');\n  urls.url('/privacy-policy/', ns.PrivacyPolicyPage, 'privacy_policy');\n\n  ns.urls = urls;\n} (Misago.prototype, Misago.prototype.UrlConf));\n"],"sourceRoot":"/source/"}