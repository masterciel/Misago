{% extends "misago/base.html" %}
{% load i18n misago_stringutils %}


{% block title %}{{ forum.name }} | {{ block.super }}{% endblock title %}


{% block meta-description %}{{ forum.description|striplinebreaks }}{% endblock meta-description %}


{% block content %}
<div{% if forum.css %} class="page-{{ forum.css_class }}"{% endif %}>
  <div class="page-header">
    <div class="container">
      {% if path %}
      <ol class="breadcrumb">
        {% for crumb in path|slice:":-1" %}
        <li>
          <a href="{{ crumb.get_absolute_url }}">{{ crumb.name }}</a>{% if not forloop.last %}<span class="fa fa-chevron-right"></span>{% endif %}
        </li>
        {% endfor %}
      </ol>
      {% endif %}

      <h1>{{ forum.name }}</h1>
    </div>
  </div>
  <div class="container">
    {% if forum.description %}
    <div class="lead">
      {{ forum.description|escape|urlize|linebreaks }}
    </div>
    {% endif %}

    {% if forum.subforums %}
    {% include "misago/forums/subforums.html" with category=forum %}
    {% endif %}

    <div class="threads-list">

      <div class="table-actions">
        {% if forum.is_closed %}
        <span class="btn btn-default disabled pull-right">
          <span class="fa fa-lock"></span>
          {% trans "This forum is closed." %}
        </span>
        {% else %}
          {% if user.is_anonymous %}
          <a href="{% url LOGIN_URL %}" class="btn btn-default pull-right">
            <span class="fa fa-check-circle"></span>
            {% trans "Sign in to start thread" %}
          </a>
          {% elif forum.acl.can_start_threads %}
          <a href="{% url 'misago:start_thread' forum_slug=forum.slug forum_id=forum.id %}" class="btn btn-success pull-right">
            <span class="fa fa-plus-circle"></span>
            {% trans "Start thread" %}
          </a>
          {% else %}
          <span class="btn btn-default btn-closed pull-right">
            <span class="fa fa-ban"></span>
            {% trans "Can't start threads" %}
          </span>
          {% endif %}
        {% endif %}
      </div>

      <div class="table-panel">
        <ul class="list-group">
          {% for thread in threads %}
          <li class="list-group-item{% if thread.is_new %} new{% endif %}">

            {% if thread.is_announcement %}
              {% if thread.is_new %}
              <span class="thread-icon tooltip-top fa fa-star fa-lg fa-fw" title="{% trans "Announcement, unread" %}"></span>
              {% else %}
              <span class="thread-icon tooltip-top fa fa-star-o fa-lg fa-fw" title="{% trans "Announcement, read" %}"></span>
              {% endif %}
            {% elif thread.is_pinned %}
              {% if thread.is_new %}
              <span class="thread-icon tooltip-top fa fa-bookmark fa-lg fa-fw" title="{% trans "Pinned, unread" %}"></span>
              {% else %}
              <span class="thread-icon tooltip-top fa fa-bookmark-o fa-lg fa-fw" title="{% trans "Pinned, read" %}"></span>
              {% endif %}
            {% else %}
              {% if thread.is_new %}
              <span class="thread-icon tooltip-top fa fa-circle fa-lg fa-fw" title="{% trans "Unread posts" %}"></span>
              {% else %}
              <span class="thread-icon tooltip-top fa fa-circle-thin fa-lg fa-fw" title="{% trans "Read posts" %}"></span>
              {% endif %}
            {% endif %}

            <a href="{{ thread.get_absolute_url }}" class="item-title">
              {{ thread.title }}
            </a>

          </li>
          {% empty %}
          <li class="list-group-item message-row">
            {% trans "No threads were posted in this forum, or you don't have permission to see them." %}
          </li>
          {% endfor %}
        </ul>
      </div>

      <div class="table-actions">
      </div>
    </div>

  </div>
</div>
{% endblock content %}


{% block javascripts %}
{{ block.super }}
{% include "misago/forums/js.html" %}
{% endblock javascripts %}
